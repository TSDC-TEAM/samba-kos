use nk.base._

use EDL samba.Env
use EDL samba.Smbd
use EDL kl.VfsRamFs
use EDL kl.VfsNet
use EDL kl.rump.Dhcpcd
use EDL kl.drivers.SDCard
use EDL kl.drivers.RAMDisk
use EDL Einit
use EDL kl.core.Core

/**
 * This policy enables to start up system entities by KOS kernel.
 */
execute src = kl.core.Core, dst = kl.core.Core
{
    grant()
}

execute src = kl.core.Core, dst = Einit
{
    grant()
}

/**
 * These instructions enables to start up and initialize entities specified in file init.yaml.in.
 */
execute src = Einit, dst = samba.Env
{
    grant()
}

execute src = Einit, dst = kl.drivers.RAMDisk
{
    grant()
}

execute src = Einit, dst = kl.drivers.SDCard
{
    grant()
}

execute src = Einit, dst = kl.VfsRamFs
{
    grant()
}

execute src = Einit, dst = kl.VfsNet
{
    grant()
}

execute src = Einit, dst = kl.rump.Dhcpcd
{
    grant()
}

execute src = Einit, dst = samba.Smbd
{
    grant()
}

/**
 * This code enables to send requests from Einit entity to KOS kernel
 * and get responses. It makes able to use system calls by Einit.
 */
request src = Einit, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = Einit
{
    grant()
}

/**
 * This code enables to send requests from Dhcpcd entity to KOS kernel
 * and get responses.
 */
request src = kl.rump.Dhcpcd, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = kl.rump.Dhcpcd
{
    grant()
}

/**
 * This code enables to send requests from RAMDisk entity to KOS kernel
 * and get responses.
 */
request src = kl.drivers.RAMDisk, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = kl.drivers.RAMDisk
{
    grant()
}

/**
 * This code enables to send requests from Env entity to KOS kernel
 * and get responses.
 */
request src = samba.Env, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = samba.Env
{
    grant()
}

/**
 * This code enables to send requests from VfsNet entity to KOS kernel
 * and get responses.
 */
request src = kl.VfsNet, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = kl.VfsNet
{
    grant()
}

/**
 * This code enables to send requests from VfsRamFs entity to KOS kernel
 * and get responses.
 */
request src = kl.VfsRamFs, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = kl.VfsRamFs
{
    grant()
}

/**
 * This code enables to send requests from Client entity to KOS kernel
 * and get responses.
 */
request src = samba.Smbd, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = samba.Smbd
{
    grant()
}

/**
 * This code enables to send requests from Dhcpcd entity to Env entity
 * and get responses.
 */
request src = kl.rump.Dhcpcd, dst = samba.Env
{
    grant()
}

response src = samba.Env, dst = kl.rump.Dhcpcd
{
    grant()
}

/**
 * This code enables to send requests from Client entity to Env entity
 * and get responses.
 */
request src = samba.Smbd, dst = samba.Env
{
    grant()
}

response src = samba.Env, dst = samba.Smbd
{
    grant()
}

/**
 * This code enables to send requests from VfsNet entity to Env entity
 * and get responses.
 */
request src = kl.VfsNet, dst = samba.Env
{
    grant()
}

response src = samba.Env, dst = kl.VfsNet
{
    grant()
}

/**
 * This code enables to send requests from VfsRamFs entity to Env entity
 * and get responses.
 */
request src = kl.VfsRamFs, dst = samba.Env
{
    grant()
}

response src = samba.Env, dst = kl.VfsRamFs
{
    grant()
}

/**
 * This code enables to send requests from Client entity to VfsRamFs entity
 * and get responses.
 */
request src = samba.Smbd, dst = kl.VfsRamFs
{
    grant()
}

response src = kl.VfsRamFs, dst = samba.Smbd
{
    grant()
}

/**
 * This code enables to send requests from Dhcpcd entity to VfsRamFs entity
 * and get responses.
 */
request src = kl.rump.Dhcpcd, dst = kl.VfsRamFs
{
    grant()
}

response src = kl.VfsRamFs, dst = kl.rump.Dhcpcd
{
    grant()
}

/**
 * This code enables to send requests from VfsRamFs entity to RAMDisk entity
 * and get responses.
 */
request src = kl.VfsRamFs, dst = kl.drivers.RAMDisk
{
    grant()
}

response src = kl.drivers.RAMDisk, dst = kl.VfsRamFs
{
    grant()
}

/**
 * This code enables to send requests from Client entity to VfsNet entity
 * and get responses.
 */
request src = samba.Smbd, dst = kl.VfsNet
{
    grant()
}

response src = kl.VfsNet, dst = samba.Smbd
{
    grant()
}

/**
 * This code enables to send requests from Dhcpcd entity to VfsNet entity
 * and get responses.
 */
request src = kl.rump.Dhcpcd, dst = kl.VfsNet
{
    grant()
}

response src = kl.VfsNet, dst = kl.rump.Dhcpcd
{
    grant()
}

/**
 * This code enables to send requests from SDCard entity to KOS kernel
 * and get responses.
 */
request src = kl.drivers.SDCard, dst = kl.core.Core
{
    grant()
}

response src = kl.core.Core, dst = kl.drivers.SDCard
{
    grant()
}

/**
 * This code enables to call methods of the security interface.
 */

security src = kl.drivers.SDCard, method = Register
{
    grant ()
}

security src = kl.drivers.RAMDisk, method = Register
{
    grant ()
}
